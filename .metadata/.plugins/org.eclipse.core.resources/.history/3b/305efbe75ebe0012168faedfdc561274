package sqliteDB;

import java.util.ArrayList;
import java.util.List;

import android.content.ContentValues;
import android.content.Context;
import android.database.Cursor;
import android.database.sqlite.SQLiteDatabase;
import android.database.sqlite.SQLiteOpenHelper;

public class EmployeeDataSource {
	
	SQLiteOpenHelper dbhelper;
	SQLiteDatabase database;
	
	private static final String[] allColumns = {
		DatabaseAdapter.COLUMN_ID,
		DatabaseAdapter.FIRST_NAME,
		DatabaseAdapter.LAST_NAME,
		DatabaseAdapter.GENDER,
		DatabaseAdapter.CITY,
		DatabaseAdapter.STATE
	};
	
	public EmployeeDataSource(Context context) {
		dbhelper = new DatabaseAdapter(context);
	}
	
	public void open() {
		database = dbhelper.getWritableDatabase();
	}
	
	public void close() {
		dbhelper.close();
	}
	
	public void create(String[] items) {
		ContentValues values = new ContentValues();
		values.put(DatabaseAdapter.FIRST_NAME, items[0]);
		values.put(DatabaseAdapter.FIRST_NAME, items[1]);
		values.put(DatabaseAdapter.FIRST_NAME, items[2]);
		values.put(DatabaseAdapter.FIRST_NAME, items[3]);
		values.put(DatabaseAdapter.FIRST_NAME, items[4]);
		database.insert(DatabaseAdapter.TABLE_EMPLOYEE, null, values);
	}
	
	public List<String> findAll() {
		List<String> employees = new ArrayList<String>();
		
		Cursor cursor = database.query(DatabaseAdapter.TABLE_EMPLOYEE, allColumns, null, null, null, null, null);
		if (cursor.getCount() > 0) {
			while (cursor.moveToNext()) {
				String str = 				 cursor.getString(cursor.getColumnIndex(DatabaseAdapter.FIRST_NAME)) + " " +
											 cursor.getString(cursor.getColumnIndex(DatabaseAdapter.LAST_NAME)) + " " +
											 cursor.getString(cursor.getColumnIndex(DatabaseAdapter.GENDER)) + "\n" +
											 cursor.getString(cursor.getColumnIndex(DatabaseAdapter.CITY)) + " " +
											 cursor.getString(cursor.getColumnIndex(DatabaseAdapter.STATE));
				
				employees.add(str);
			}
		}
		return employees;
	}
}
